!function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=37)}([function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(){function e(){this.title="Welcome to Tyler-CMT Api"}return e.prototype.responseData=function(e,t,n){t.locals.BASE_URL="/",t.locals.title=this.title,t.status(200),t.send(n)},e}()},function(e,t){e.exports=require("mongoose")},function(e){e.exports={f:"this is a my secret",b:"mongodb://odin.kulfi.io:17027/admin",a:"api",d:"api-writer",c:"apiwriter",e:"((?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%]).{6,20})"}},function(e,t,n){"use strict";var r=n(4),s=n(2),i=n(1),a=n(8),o=n(13),u=n(7),c=function(){function e(){}return Object.defineProperty(e.prototype,"schema",{get:function(){var e=new i.Schema({id:{type:String,index:!0,required:[!0,"is required"]},username:{type:String,lowercase:!0,required:[!0,"is required"],match:[/[a-zA-Z0-9-_]{5,20}\w+/,"is invalid"],unique:!0,index:!0},email:{type:String,lowercase:!0,required:[!0,"is required"],match:[/\S+@\S+\.\S+/,"is invalid"],unique:!0,index:!0},firstName:{type:String,required:[!0,"is required"],index:!0},lastName:{type:String,required:[!0,"is required"],index:!0},salt:{type:String},password_hash:{type:String,index:!0},userTypeId:{type:i.Schema.Types.ObjectId,required:!0,index:!0,ref:"UserTypes"},active:{type:Boolean,default:!0},tokenValidated:{type:Boolean,default:!1},validationToken:{type:String,index:!0}},{timestamps:!0});return e.plugin(a,{message:"is already taken"}),e.methods.matchPasswordCriteria=function(e){return e.match(s.e)},e.methods.expiresIn=function(e){var t=new Date;return t.setDate(t.getDate()+e)},e.methods.setPassword=function(t){if(e.methods.matchPasswordCriteria(t)){this.salt=o.randomBytes(16).toString("hex");var n=o.createHmac("sha512",this.salt);n.update(t);var r=n.digest("hex");return!!r&&(this.password_hash=r,!0)}return console.error("password","does not match criteria"),!1},e.methods.generateValidationToken=function(){var t=e.methods.expiresIn(1);try{var n=u.sign({username:this.username,exp:t},s.f);return this.tokenValidated=!1,this.validationToken=n,n}catch(e){return null}},e.methods.validPassword=function(e){if(!e)return!1;var t=o.createHmac("sha512",this.salt);t.update(e);var n=t.digest("hex");return this.password_hash===n},e},enumerable:!0,configurable:!0}),e}(),d=r.a.dbConnection.model("apiUsers",(new c).schema);t.a=d},function(e,t,n){"use strict";(function(e){var r=n(1),s=n(2),i=function(){function t(){}return t.connect=function(){var t=this,n={useNewUrlParser:!0,useCreateIndex:!0,useFindAndModify:!1,autoIndex:!1,autoReconnect:!0,reconnectTries:Number.MAX_VALUE,reconnectInterval:500,poolSize:10,bufferMaxEntries:0,connectTimeoutMS:1e4,socketTimeoutMS:45e3,family:4,user:s.d,pass:s.c,dbName:s.a};return this.dbInstance?this.dbInstance:(new Promise(function(i,a){var o=function(e){var t=r.connect(s.b,n);t?a("DB connection failure"):i("connected")};t.dbConnection=r.connection,t.dbConnection.once("open",function(){console.log("Connected to mongodb")}),t.dbConnection.on("error",function(e){console.error("Mongoode default connection has occured  "+e+" error")}),r.connection.once("disconnected",function(){console.log("Mongoose default connection disconnected"),o(t.dbInstance)}),r.connection.once("reconnected",function(){console.log("Mongoose default connection reconnected")}),e.on("SIGINT",function(){t.dbConnection.close(function(){console.log("db connection","Mongoose default connection")})}),o(t.dbInstance)}).then(function(){return t.dbInstance}).catch(function(e){return e}),null)},t}();i.connect(),t.a=i}).call(this,n(15))},function(e,t){e.exports=require("uuid")},function(e,t,n){"use strict";var r=n(4),s=n(2),i=n(8),a=n(1),o=n(7),u=function(){function e(){}return Object.defineProperty(e.prototype,"schema",{get:function(){var e=new a.Schema({id:{type:String,index:!0,required:[!0,"is required"]},ipAddress:{type:String,required:[!0,"is required"],validate:[/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,"is invalid"],index:!0},name:{type:String,required:[!0,"is required"],lowercase:!0,unique:!0},description:{type:String,required:[!0,"is required"]},contactName:{type:String,required:[!0,"is required"]},email:{type:String,lowercase:!0,required:[!0,"is required"],validate:[/\S+@\S+\.\S+/,"is invalid"],index:!0},phoneNumber:{type:String,required:[!0,"is required"],validate:[/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,"is invalid"],index:!0},token:{type:String,index:!0},active:{type:Boolean,retuired:!0,required:[!0,"is required"]}},{timestamps:!0});return e.plugin(i,{message:"is already taken"}),e.methods.generateValidationToken=function(){var e=new Date,t=new Date(e);t.setDate(e.getFullYear()+5);try{var n=o.sign({id:this._id,address:this.ipAddress,exp:t.getTime()},s.f);return this.token=n,n}catch(e){return null}},e},enumerable:!0,configurable:!0}),e}(),c=r.a.dbConnection.model("ValidClients",(new u).schema);t.a=c},function(e,t){e.exports=require("jsonwebtoken")},function(e,t){e.exports=require("mongoose-unique-validator")},function(e,t,n){"use strict";var r=n(4),s=n(8),i=n(1),a=function(){function e(){}return Object.defineProperty(e.prototype,"schema",{get:function(){var e=new i.Schema({id:{type:String,index:!0,required:[!0,"is required"]},display:{type:String,required:[!0,"is required"],lowercase:!0,unique:!0},description:{type:String,required:[!0,"is required"]},active:{type:Boolean,retuired:!0,required:[!0,"is required"]}},{timestamps:!0});return e.plugin(s,{message:"is already taken"}),e},enumerable:!0,configurable:!0}),e}(),o=r.a.dbConnection.model("UserTypes",(new a).schema);t.a=o},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(18),s=n(14),i=n(1),a=function(){function e(){}return e.prototype.encryptData=function(e){return s.AES.encrypt(e,r.a).toString()},e.prototype.decryptData=function(e){return s.AES.decrypt(e,r.a).toString(s.enc.Utf8)},e.prototype.mongoIdObject=function(e){return i.Types.ObjectId(e)},e}();new a},function(e,t,n){"use strict";var r=function(){return function(){}}();t.a=r},function(e,t){e.exports=require("ejs")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("crypto-js")},function(e,t){var n,r,s=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function o(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],d=!1,p=-1;function f(){d&&u&&(d=!1,u.length?c=u.concat(c):p=-1,c.length&&m())}function m(){if(!d){var e=o(f);d=!0;for(var t=c.length;t;){for(u=c,c=[];++p<t;)u&&u[p].run();p=-1,t=c.length}u=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function l(e,t){this.fun=e,this.array=t}function y(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new l(e,t)),1!==c.length||d||o(m)},l.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=y,s.addListener=y,s.once=y,s.off=y,s.removeListener=y,s.removeAllListeners=y,s.emit=y,s.prependListener=y,s.prependOnceListener=y,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("body-parser")},function(e){e.exports={a:"this is a test"}},function(e,t,n){"use strict";(function(e){var r=n(16),s=n(20),i=n(21),a=n(17),o=n(22),u=n(23),c=n(24),d=n(35),p=n(36),f=n(34),m=n(33),l=n(31),y=n(30),g=n(32),h=n(25),v=n(12),b=function(){function t(){e.title="tyler-cmt-api",this.server=r(),this.server.engine("html",v.renderFile),this.server.set("view engine","html"),this.server.set("view engine","ejs"),this.configureMiddleware(),this.routes()}return t.prototype.configureMiddleware=function(){this.server.use(i("dev")),this.server.use(a.urlencoded({extended:!1})),this.server.use(a.json()),this.server.use(o()),this.server.disable("x-powered-by"),this.server.all("/*",s()),this.server.all("/v1/*",c.a.validate)},t.prototype.routes=function(){var e=r.Router();g.a.map(e),h.a.map(e),u.a.map(e),d.a.map(e),f.a.map(e),p.a.map(e),m.a.map(e),l.a.map(e),y.a.map(e),this.server.use(e)},t.prototype.run=function(e,t){this.server.listen(e,t,function(){console.log("listening on port: "+e)})},t}();t.a=new b}).call(this,n(15))},function(e,t){e.exports=require("cors")},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("helmet")},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r,s=n(0),i=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=function(e){function t(){return e.call(this)||this}return i(t,e),t.map=function(e){e.get("/",function(e,n,r){(new t).index(e,n,r)})},t.prototype.index=function(e,t,n){this.title="Index | Tyler-CMT";this.responseData(e,t,{message:"Welcome!"})},t}(s.a)},function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(7),s=n(2),i=n(6),a=function(){function e(){}return e.validate=function(e,t,n){var a=(e.body&&e.body.access_token||e.query&&e.query.access_token||e.headers.x_access_token).toString().trim(),o=e.headers&&e.headers.forwarded?e.headers.forwarded:e.connection.remoteAddress;if(!a||!o)return t.status(400).send({message:"Invalid token or address"});try{var u=r.verify(a,s.f);return u?u.exp<=Date.now()?t.status(400).send({message:"Token Expired"}):o!==u.address?t.status(400).send({message:"Unauthorized address"}):void i.a.findById(u.id,function(e,r){return e?t.status(400).send(e.message):r&&r.active?n():t.status(417).send({message:"Inactive token"})}):t.status(400).send({message:"Decoding error"})}catch(e){return t.status(400).send({message:e.message})}},e}();new a},function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r,s=n(0),i=n(26),a=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=function(e){function t(){return e.call(this)||this}return a(t,e),t.map=function(e){e.post("/mail/send",i.a.send)},t}(s.a)},function(e,t,n){"use strict";(function(e){var r,s=n(10),i=n(27),a=n(28),o=n(29),u=n(12),c=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=(n(38),function(t){function n(){var e=t.call(this)||this;return e.send=function(t,n){var r=e.sendMail();return"boolean"==typeof r?r?n.status(200).send({message:"sent email"}):n.status(400).send({message:"send email failed"}):typeof r==typeof Error?n.status(400).send({message:r.message}):n.status(444).send({message:"type check failed"})},e.transporter=o.createTransport({service:"GMAIL",auth:{user:"kulfiapp@gmail.com",pass:"@2Terravista"}}),e}return c(n,t),n.prototype.sendMail=function(){var t=i.join(e,"../email-templates","greetings.html");try{var n=new a({message:{from:"kulfiapp@gmail.com"},transport:this.transporter,views:{options:{extension:"ejs"}}}),r=u.render(t,{userName:"Tester-Ashish"});return n.juiceResources(r).then(console.log).catch(console.error),!0}catch(e){return e}},n}(s.a));t.a=new d}).call(this,"/")},function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var s=e[r];"."===s?e.splice(r,1):".."===s?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(e){return r.exec(e).slice(1)};function i(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var a=s>=0?arguments[s]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,r="/"===a.charAt(0))}return(r?"/":"")+(t=n(i(t.split("/"),function(e){return!!e}),!r).join("/"))||"."},t.normalize=function(e){var r=t.isAbsolute(e),s="/"===a(e,-1);return(e=n(i(e.split("/"),function(e){return!!e}),!r).join("/"))||r||(e="."),e&&s&&(e+="/"),(r?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(i(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var s=r(e.split("/")),i=r(n.split("/")),a=Math.min(s.length,i.length),o=a,u=0;u<a;u++)if(s[u]!==i[u]){o=u;break}var c=[];for(u=o;u<s.length;u++)c.push("..");return(c=c.concat(i.slice(o))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=s(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},t.basename=function(e,t){var n=s(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return s(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(15))},function(e,t){e.exports=require("email-templates")},function(e,t){e.exports=require("nodemailer")},function(e,t,n){"use strict";var r=n(0),s=n(5),i=n(4),a=n(8),o=n(1),u=function(){function e(){}return Object.defineProperty(e.prototype,"schema",{get:function(){var e=new o.Schema({id:{type:String,required:[!0,"is required"],index:!0},display:{type:String,require:[!0,"is required"],unique:!0,lowercase:!0},price:{type:Number,require:[!0,"is required"],unique:!0},active:{type:Boolean,required:[!0,"is required"],default:!0}},{timestamps:!0});return e.plugin(a,{message:"is already taken"}),e},enumerable:!0,configurable:!0}),e}(),c=i.a.dbConnection.model("Duration",(new u).schema),d=function(){return function(){}}(),p=new(function(){function e(){var e=this;this.getAll=function(t,n){c.find({active:!0},function(t,r){if(t)return n.status(500).send({message:t.message});var s=e.mapItems(r);return n.status(200).send(s)})},this.getOne=function(t,n){try{return t.params&&t.params.id?void c.findById(t.params.id,function(t,r){if(t)return n.status(500).send({message:t.message});var s=e.mapItem(r);return n.status(200).send(s)}):n.status(400).send()}catch(e){return n.status(400).send({message:e.message})}},this.create=function(t,n){try{if(!t.body||!t.body.description||!t.body.display)return n.status(400).send();var r=new d;return r.id=s(),r.active=!0,r.display=t.body.display,r.price=t.body.price,void c.create(r,function(t,r){if(t)return n.status(400).send({message:t.message});var s=e.mapItem(r);return n.status(201).send(s)})}catch(e){return n.status(400).send({message:e.message})}},this.update=function(e,t){try{if(!e.params||!e.params.id)return t.status(400).send();var n=e.body.price?e.body.price:"",r=e.body.display?e.body.display:"";if(n>0||0==r.length)return t.status(400).send({message:"description or display is null or empty"});var s=new c({display:r,price:n});return void c.findByIdAndUpdate(e.params.id,s,function(e){return e?t.status(400).send({message:e.message}):t.status(200).send()})}catch(e){return t.status(400).send({message:e.message})}},this.deactivate=function(e,t){try{return e.params&&e.params.id?void c.findByIdAndUpdate(e.params.id,{active:!1},function(e){return e?t.status(400).send({message:e.message}):t.status(204).send()}):t.status(400).send()}catch(e){return t.status(400).send({message:e.message})}}}return e.prototype.mapItems=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this.mapItem(e[n]));return t},e.prototype.mapItem=function(e){var t=new d;return t.active=e.active,t.display=e.display,t.id=e.id,t.price=e.price,t},e}());n.d(t,"a",function(){return l});var f,m=(f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(){return e.call(this)||this}return m(t,e),t.map=function(e){e.get("/v1/admin/duration",p.getAll),e.get("/v1/admin/duration/:id",p.getOne),e.post("/v1/admin/duration",p.create),e.put("/v1/admin/duration/:id",p.update),e.delete("/v1/admin/duration/:id",p.deactivate)},t}(r.a)},function(e,t,n){"use strict";var r=n(0),s=n(5),i=n(4),a=n(1),o=function(){function e(){}return Object.defineProperty(e.prototype,"schema",{get:function(){return new a.Schema({id:{type:String,required:[!0,"is required"],index:!0},description:{type:String,required:[!0,"is required"]},shortDescription:{type:String,required:[!0,"is required"]},active:{type:Boolean,required:[!0,"is required"],default:!0,index:!0}},{timestamps:!0})},enumerable:!0,configurable:!0}),e}(),u=i.a.dbConnection.model("Services",(new o).schema),c=function(){return function(){}}(),d=new(function(){function e(){var e=this;this.getAll=function(t,n){u.find({active:!0},function(t,r){if(t)return n.status(500).send({message:t.message});var s=e.mapItems(r);return n.status(200).send(s)})},this.getOne=function(t,n){try{return t.params&&t.params.id?void u.findById(t.params.id,function(t,r){if(t)return n.status(500).send({message:t.message});var s=e.mapItem(r);return n.status(200).send(s)}):n.status(400).send()}catch(e){return n.status(400).send({message:e.message})}},this.create=function(t,n){try{if(!t.body||!t.body.description||!t.body.shortDescription)return n.status(400).send();var r=new c;return r.id=s(),r.active=!0,r.description=t.body.description,r.shortDescription=t.body.shortDescription,void u.create(r,function(t,r){if(t)return n.status(400).send({message:t.message});var s=e.mapItem(r);return n.status(201).send(s)})}catch(e){return n.status(400).send({message:e.message})}},this.update=function(e,t){try{if(!e.params||!e.params.id)return t.status(400).send();var n=e.body.description?e.body.description:"",r=e.body.shortDescription?e.body.shortDescription:"";if(0==n.length||0==r.length)return t.status(400).send({message:"description is null or empty"});var s=new u({description:n,shortDesc:r});return void u.findByIdAndUpdate(e.params.id,s,function(e){return e?t.status(400).send({message:e.message}):t.status(200).send()})}catch(e){return t.status(400).send({message:e.message})}},this.deactivate=function(e,t){try{return e.params&&e.params.id?void u.findByIdAndUpdate(e.params.id,{active:!1},function(e){return e?t.status(400).send({message:e.message}):t.status(204).send()}):t.status(400).send()}catch(e){return t.status(400).send({message:e.message})}}}return e.prototype.mapItems=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this.mapItem(e[n]));return t},e.prototype.mapItem=function(e){var t=new c;return t.active=e.active,t.description=e.description,t.id=e.id,t.shortDescription=e.shortDescription,t},e}());n.d(t,"a",function(){return m});var p,f=(p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=function(e){function t(){return e.call(this)||this}return f(t,e),t.map=function(e){e.get("/v1/admin/service",d.getAll),e.get("/v1/admin/service/:id",d.getOne),e.post("/v1/admin/service",d.create),e.put("/v1/admin/service/:id",d.update),e.delete("/v1/admin/service/:id",d.deactivate)},t}(r.a)},function(e,t,n){"use strict";var r=n(0),s=function(){return function(){}}(),i=new(function(){return function(){this.getAll=function(e,t){var n=new s;return n.hostname=e.hostname,n.ip=e.connection.remoteAddress,n.forwared=e.headers.forwarded?e.headers.forwarded:"",t.status(200).send(n)}}}());n.d(t,"a",function(){return u});var a,o=(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e){function t(){return e.call(this)||this}return o(t,e),t.map=function(e){e.get("/clientinfo",i.getAll)},t}(r.a)},function(e,t,n){"use strict";var r=n(0),s=n(5),i=n(6),a=function(){return function(){}}(),o=new(function(){function e(){var e=this;this.getAll=function(t,n){i.a.find({active:!0},function(t,r){if(t)return n.status(500).send({message:t.message});var s=e.mapItems(r);return n.status(200).send(s)})},this.getOne=function(t,n){try{return t.params&&t.params.id?void i.a.findById(t.params.id,function(t,r){if(t)return n.status(500).send({message:t.message});e.mapItem(r);return n.status(200).send(r)}):n.status(400).send()}catch(e){return n.status(400).send({message:e.message})}},this.create=function(t,n){try{if(!(t.body.active&&t.body.contactname&&t.body.description&&t.body.email&&t.body.ipaddress&&t.body.name&&t.body.phonenumber))return n.status(400).send({message:"required data is missing"});var r=new i.a({id:s(),active:!0,contactName:t.body.contactname,description:t.body.description,email:t.body.email,ipAddress:t.body.ipaddress,name:t.body.name,phoneNumber:t.body.phonenumber});return r.generateValidationToken(),void i.a.create(r,function(t,r){if(t)return n.status(400).send({message:t.message});var s=e.mapItem(r);return n.status(201).send(s)})}catch(e){return n.status(400).send({message:e.message})}},this.update=function(e,t){try{if(!(e.body.contactname&&e.body.description&&e.body.email&&e.body.fdnq&&e.body.ipaddress&&e.body.name&&e.body.phonenumber))return t.status(400).send({message:"required data is missing"});var n=new a;return n.contactName=e.body.contactname,n.description=e.body.description,n.email=e.body.email,n.ipAddress=e.body.ipaddress,n.name=e.body.name,n.phoneNumber=e.body.phonenumber,void i.a.findByIdAndUpdate(e.params.id,n,function(e){return e?t.status(400).send({message:e.message}):t.status(200).send()})}catch(e){return t.status(400).send({message:e.message})}},this.deactivate=function(e,t){try{return e.params&&e.params.id?void i.a.findByIdAndUpdate(e.params.id,{active:!1,token:""},function(e){return e?t.status(400).send({message:e.message}):t.status(204).send()}):t.status(400).send()}catch(e){return t.status(400).send({message:e.message})}}}return e.prototype.mapItems=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this.mapItem(e[n]));return t},e.prototype.mapItem=function(e){console.log("_id",e._id);var t=new a;return t.active=e.active,t.contactName=e.contactName,t.description=e.description,t.email=e.email,t.id=e.id,t.ipAddress=e.ipAddress,t.name=e.name,t.phoneNumber=e.phoneNumber,t},e}());n.d(t,"a",function(){return d});var u,c=(u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(){return e.call(this)||this}return c(t,e),t.map=function(e){e.get("/v1/admin/client",o.getAll),e.get("/v1/admin/client/:id",o.getOne),e.post("/v1/admin/client",o.create),e.put("/v1/admin/client/:id",o.update),e.delete("/v1/admin/client/:id",o.deactivate)},t}(r.a)},function(e,t,n){"use strict";var r,s=n(0),i=n(5),a=n(3),o=n(9),u=function(){return function(){}}(),c=n(11),d=n(10),p=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),f=new(function(e){function t(){var t=e.call(this)||this;return t.getAll=function(e,n){try{return void a.a.aggregate([{$match:{active:!0}},{$lookup:{from:"usertypes",localField:"userTypeId",foreignField:"_id",as:"userType"}},{$sort:{username:1}},{$limit:200}]).exec(function(e,r){if(e)return n.status(400).send({message:e.message});var s=t.mapItems(r);return n.status(200).send(s)})}catch(e){return n.status(400).send({message:e.message})}},t.getOne=function(e,n){try{return e.params&&e.params.id?void a.a.aggregate([{$match:{id:e.params.id,active:!0}},{$lookup:{from:"usertypes",localField:"userTypeId",foreignField:"_id",as:"userType"}},{$limit:1}]).exec(function(e,r){if(e)return n.status(400).send({message:e.message});var s=t.mapItems(r);return n.status(200).send(s)}):n.status(400).send()}catch(e){return n.status(400).send({message:e.message})}},t.create=function(e,n){try{if(!(e.body&&e.body.email&&e.body.firstName&&e.body.lastName&&e.body.username&&e.body.password))return n.status(400).send({message:"missing data item(s)"});var r="";return t.email=e.body.email,t.firstName=e.body.firstName,t.lastName=e.body.lastName,t.username=e.body.username,t.password=e.body.password,t.type=e.body.type,""==t.email?n.status(400).send({message:"failed to decrypt"}):void o.a.findOne({active:!0,display:t.type},function(e,t){if(e)return n.status(400).send({message:e.message});t&&(r=t._id)}).then(function(){if(r){var e=new a.a({id:i(),email:t.email,firstName:t.firstName,lastName:t.lastName,username:t.username,userTypeId:r});if(!e.setPassword(t.password))return n.status(400).send({message:"password does not match criteria"});if(!e.generateValidationToken())return n.status(400).send({message:"error occured while generating token"});a.a.create(e,function(e,t){return e?n.status(400).send({message:e.message}):n.status(201).send({message:"created"})})}})}catch(e){return n.status(400).send({message:e.message})}},t.update=function(e,t){try{if(!e.params||!e.params.id)return t.status(400).send({message:"target id is invalid"});if(!(e.body&&e.body.firstName&&e.body.lastName&&e.body.username))return t.status(400).send();var n=e.body.firstName?e.body.firstName:"",r=e.body.lastName?e.body.lastName:"";if(0==n.length||0==r.length)return t.status(400).send({message:"missing and null or empty data"});var s=new a.a({firstName:n,lastName:r});return void a.a.findByIdAndUpdate({id:e.params.id},s,function(e){return e?t.status(400).send({message:e.message}):t.status(200).send()})}catch(e){return t.status(400).send({message:e.message})}},t.deactivate=function(e,t){try{return e.params&&e.params.id?void a.a.findByIdAndUpdate(e.params.id,{active:!1},function(e){return e?t.status(400).send({message:e.message}):t.status(204).send({message:"deactivated"})}):t.status(400).send()}catch(e){return t.send(400).send({message:e.message})}},t.username="",t.email="",t.firstName="",t.lastName="",t.password="",t.type="",t}return p(t,e),t.prototype.mapItems=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this.mapItem(e[n]));return t},t.prototype.mapItem=function(e){var t=new u,n=JSON.parse(JSON.stringify(e)),r=new c.a;return r.id=this.encryptData(n.userType[0].id),r.display=this.encryptData(n.userType[0].display),r.description=this.encryptData(n.userType[0].description),r.active=n.userType[0].active,t.active=n.active,t.email=this.encryptData(n.email),t.firstName=this.encryptData(n.firstName),t.id=this.encryptData(n.id),t.lastName=this.encryptData(n.lastName),t.tokenValidated=n.tokenValidated,t.username=this.encryptData(n.username),t.userType=r,t},t}(d.a));n.d(t,"a",function(){return l});var m=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(e){function t(){return e.call(this)||this}return m(t,e),t.map=function(e){e.get("/v1/apiuser",f.getAll),e.get("/v1/apiuser/:id",f.getOne),e.post("/v1/apiuser",f.create),e.put("/v1/apiuser/:id",f.update),e.delete("/v1/apiuser/:id",f.deactivate)},t}(s.a)},function(e,t,n){"use strict";var r,s=n(0),i=n(7),a=n(2),o=n(3),u=n(10),c=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=new(function(e){function t(){var t=e.call(this)||this;return t.login=function(e,n){try{return e.body.username&&e.body.password?(t.username=t.decryptData(e.body.username),t.password=t.decryptData(e.body.password),void o.a.findOne({username:t.username}).exec(function(e,r){return e?n.status(400).send({message:e.message}):r?r.validPassword(t.password)?r.tokenValidated?n.status(200).send({message:"Welcome back!"}):n.status(301).send({message:"please validate your email"}):n.status(400).send({message:"either username or password in incorrect!"}):n.status(400).send({message:"user does not exist"})})):n.status(400).send()}catch(e){return n.status(400).send({message:e.message})}},t.resetPassword=function(e,t){try{return e.body.username&&e.body.password?void o.a.findOne({username:e.body.user}).exec(function(n,r){if(n)return t.status(400).send({message:n.message});if(r){if(!r.setPassword(e.body.password))return t.status(400).send("either username or password in incorrect!");o.a.findByIdAndUpdate(r._id,{salt:r.salt,password_hash:r.password_hash},function(e){return e?t.status(400).send({message:e.message}):t.status(200).send()})}return t.status(417).send()}):t.status(400).send()}catch(e){return t.status(400).send({message:e.message})}},t.validateEmailToken=function(e,t){try{if(!e.params.token)return t.status(400).send();var n=i.verify(e.params.token,a.f);return n?(n.exp>Date.now()/1e3&&o.a.findByIdAndUpdate(n.id,{tokenValidated:!0},function(e){return e?t.status(400).send(e.message):t.status(200).send()}),t.status(400).send({message:"Token expired"})):t.status(400).send({message:"decoding failure"})}catch(e){return t.status(400).send({message:e.message})}},t.username="",t.password="",t}return c(t,e),t}(u.a));n.d(t,"a",function(){return f});var p=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(e){function t(){return e.call(this)||this}return p(t,e),t.map=function(e){e.post("/v1/login/:token",d.validateEmailToken),e.post("/v1/login",d.login),e.post("/v1/resetpass",d.resetPassword)},t}(s.a)},function(e,t,n){"use strict";var r=n(0),s=n(5),i=n(9),a=n(11),o=new(function(){function e(){var e=this;this.getAll=function(t,n){i.a.find({active:!0},function(t,r){if(t)return n.status(500).send({message:t.message});console.log("data",r);var s=e.mapItems(r);return n.status(200).send(s)})},this.getOne=function(t,n){try{return t.params&&t.params.id?void i.a.findById(t.params.id,function(t,r){if(t)return n.status(500).send({message:t.message});var s=e.mapItem(r);return n.status(200).send(s)}):n.status(400).send()}catch(e){return n.status(400).send({message:e.message})}},this.create=function(t,n){try{if(!t.body||!t.body.description||!t.body.display)return n.status(400).send();var r=new a.a;return r.id=s(),r.description=t.body.description,r.display=t.body.display,r.active=!0,void i.a.create(r,function(t,r){if(t)return n.status(400).send({message:t.message});var s=e.mapItem(r);return n.status(201).send(s)})}catch(e){return n.status(400).send({message:e.message})}},this.update=function(e,t){try{if(!e.params||!e.params.id)return t.status(400).send();var n=e.body.description?e.body.description:"",r=e.body.display?e.body.display:"";if(0==n.length||0==r.length)return t.status(400).send({message:"description or display is null or empty"});var s={description:n,display:r};return void i.a.findByIdAndUpdate(e.params.id,s,function(e){return e?t.status(400).send({message:e.message}):t.status(200).send()})}catch(e){return t.status(400).send({message:e.message})}},this.deactivate=function(e,t){try{return e.params&&e.params.id?void i.a.findByIdAndUpdate(e.params.id,{active:!1},function(e){return e?t.status(400).send({message:e.message}):t.status(204).send()}):t.status(400).send()}catch(e){return t.status(400).send({message:e.message})}}}return e.prototype.mapItems=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this.mapItem(e[n]));return t},e.prototype.mapItem=function(e){console.log("type: "+e.display,e._id);var t=new a.a;return t.active=e.active,t.description=e.description,t.display=e.display,t.id=e.id,t},e}());n.d(t,"a",function(){return d});var u,c=(u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e){function t(){return e.call(this)||this}return c(t,e),t.map=function(e){e.get("/v1/admin/usertype",o.getAll),e.get("/v1/admin/usertype/:id",o.getOne),e.post("/v1/admin/usertype",o.create),e.put("/v1/admin/usertype/:id",o.update),e.delete("/v1/admin/usertype/:id",o.deactivate)},t}(r.a)},function(e,t,n){"use strict";n.r(t);n(19).a.run(3001,"127.0.0.1")},function(e,t){e.exports=require("mail")}]);
//# sourceMappingURL=tyler.api.bundle.js.map